---
title: SpringCloud面试题总结
date: 2020-11-24
sidebar: 'auto'
categories:
 - 面试
tags:
 - SpringCloud
 - SpringCloudAlibaba
---

[toc]

# SpringCloud面试题总结

## 什么是微服务？

微服务架构是一种架构模式或者说是一种架构风格，它提倡将单一应用程序划分为一组小的服务，每个服务运行在其独立的自己的进程中，服务之间相互协调、互相配合，为用户提供最终价值。服务之间采用轻量级的通信机制互相沟通,每个服务都围绕着具体的业务进行构建，并且能够被独立的构建在生产环境、类生产环境等。另外，应避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建，可以有一个非常轻量级的集中式管理来协调这些服务，可以使用不同的语言来编写服务，也可以使用不同的数据存储。

## 什么是 Spring Cloud？有什么优势？

Spring cloud 是基于 Spring Boot 的 Spring 集成应用程序，可以提供与外部系统的集成。

使用 Spring cloud 开发分布式微服务时，可以解决以下问题
1. 与分布式系统相关的复杂性-这种开销包括网络问题，延迟开销，带宽问题，安全问题。
2. 服务发现-服务发现工具管理群集中的流程和服务如何查找和互相交谈。它涉及一个服务目录，在该目录中注册服务，然后能够查找并连接到该目录中的服务。
3. 冗余-分布式系统中的冗余问题。
4. 负载平衡 --负载平衡改善跨多个计算资源的工作负荷，诸如计算机，计算机集群，网络链路，中央处理单元，或磁盘驱动器的分布。
5. 性能-问题 由于各种运营开销导致的性能问题。
6. 部署复杂性-Devops 技能的要求。

## 什么是服务熔断？什么是服务降级？

熔断机制是应对雪崩效应的一种微服务链路保护机制。当某个微服务不可用或者响应时间太长时，会进行服务熔断，快速返回“错误”的响应信息。当检测到该节点微服务调用响应正常后恢复调用链路。

服务降级，一般是从整体负荷考虑。就是当某个服务熔断之后，服务器将不再被调用，此时客户端可以自己准备一个本地的fallback回调，返回一个缺省值。这样做，虽然水平下降，但好歹可用，比直接挂掉强。

## 服务注册和发现是什么意思？Spring Cloud 如何实现？

当我们开始一个项目时，我们通常在属性文件中进行所有的配置。随着越来越多的服务开发和部署，添加和修改这些属性变得更加复杂。有些服务可能会下降，而某些位置可能会发生变化。手动更改属性可能会产生问题。 Eureka 服务注册和发现可以在这种情况下提供帮助。由于所有服务都在 Eureka 服务器上注册并通过调用 Eureka 服务器完成查找，因此无需处理服务地点的任何更改和处理。

## SpringBoot和SpringCloud的区别？

SpringBoot专注于快速方便的开发单个个体微服务。

SpringCloud是关注全局的微服务协调整理治理框架，它将SpringBoot开发的一个个单体微服务整合并管理起来，为各个微服务之间提供，配置管理、服务发现、断路器、路由、微代理、事件总线、全局锁、决策竞选、分布式会话等等集成服务

SpringBoot可以离开SpringCloud独立使用开发项目， 但是SpringCloud离不开SpringBoot ，属于依赖的关系

SpringBoot专注于快速、方便的开发单个微服务个体，SpringCloud关注全局的服务治理框架。


## 什么是SpringCloudConfig?

在分布式系统中，由于服务数量巨多，为了方便服务配置文件统一管理，实时更新，所以需要分布式配置中心组件。在Spring Cloud中，有分布式配置中心组件spring cloud config ，它支持配置服务放在配置服务的内存中（即本地），也支持放在远程Git仓库中。

在spring cloud config 组件中，分两个角色，一是config server，二是config client。使用：（1）添加pom依赖（2）配置文件添加相关配置（3）启动类添加注解@EnableConfigServer

## 负载平衡的意义什么？

在计算中，负载平衡可以改善跨计算机，计算机集群，网络链接，中央处理单元或磁盘驱动器等多种计算资源的工作负载分布。负载平衡旨在优化资源使用，最大化吞吐量，最小化响应时间并避免任何单一资源的过载。使用多个组件进行负载平衡而不是单个组件可能会通过冗余来提高可靠性和可用性。负载平衡通常涉及专用软件或硬件，例如多层交换机或域名系统服务器进程。



## 为什么需要注册中心？

由于微服务架构需要把一个单体应用拆分为各个微小的服务。并且服务与服务之间需要互相配合才能完成一个业务功能。

那么各个服务之间如何互相配合？答案就是注册中心。

注册中心通过记录各个服务的信息，从而让服务与服务之间互相连通。

注册中心中存储的内容是：服务的ip+port+服务配置等。

## 如何设计一个注册中心，需要哪些接口？

- 服务注册接口：把服务注册到注册中心的功能。
- 服务心跳接口：检测注册中心的服务是否有效或者网络是否连通。
- 服务下线接口：把服务从注册中心中下线。
- 服务剔除接口：注册中心将无效的服务，从注册中心表中删除的功能。
- 查询服务接口：给其他服务提供注册中心的注册表的信息。
- 注册表同步接口：当注册中心是集群的时候，提供一个互相之间同步注册表的接口。

## 介绍一下 RESTFUL？

RESTFUL是一种编码约定。对于同一个接口，根据http请求方式的不同，来实现不同的功能。

- 对于get请求，接口实现查询功能。
- 对于post请求，接口实现新增功能。
- 对于put请求，接口实现修改功能。
- 对于delet请求，接口实现删除功能。


## 为什么微服务需要熔断机制？

熔断机制就是当服务发生故障的时候，如何进行响应的一种机制。

> 什么是服务故障？

例如网络波动异常，一时间大流量导致的处理时间过慢的异常，服务不可调用的异常等。

由于微服务架构中服务与服务之间需要互相调用才能实现业务功能。一个业务功能可能需要调用7-8个服务才能实现。但是当某个业务发生故障的时候,可能会导致涉及到该服务的业务功能全部发生故障。

当服务发生故障的时候，为了不让故障服务去影响其他服务的正常使用。我们需要通过熔断机制来限制故障服务的调用。例如直接返回默认值，限制服务的QPS等。

## 熔断和降级的区别？

相同性：熔断和降级都是一种机制。为了防止系统整体响应缓慢的机制。

不同性：熔断一般是某个业务功能中的服务（下游服务）故障导致的。而降级一般是某个服务对于大流量的请求处理缓慢，为了让服务的响应时间加快，从而限制降低了服务的请求处理。

## 微服务设计一般都遵循什么原则？

1. 单一职责原则：服务与服务之间互相独立。每个服务只处理自己的业务。做到高内聚，低耦合。
2. 服务自治原则：每个服务都能做到独立开发，独立测试，独立部署，独立运行。让服务与其他服务进行解耦。
3. 轻量通信原则：服务与服务之间的通信调用是轻量级的，并且能够跨平台，跨语言的。

## Ribbon的原理是什么？

1. 通过拦截器将被注解@LoadBalanced修改的请求进行拦截。
2. 将请求中的服务名信息，会根据注册中心的注册表，解析成具体的ip地址。如果服务名对于多个ip地址，那么ribbon在选择地址的时候，会进行负载均衡。
3. 当确定好ip地址的时候，ribbon会放行请求。

## 什么是Cache aside 缓存更新机制？

Cache aside 缓存更新机制是用于保存数据库和缓存的数据一致性的机制。

Cache aside 缓存更新机制：
1. 当应用读取数据的时候，先从缓存中读取数据，若没有得到，则从数据库中读取数据，成功后，存放到缓存中。
2. 当应用对数据进行更新的时候，先在数据库中对数据进行更新。更新成功后，将缓存中的对应数据进行删除。

> Cache aside 缓存更新机制的问题

当读取操作A比更新操作B先开始，若读取操作A比更新操作B完结束的时候。由于读取操作会将旧数据存储到缓存中，而数据库中存储的是新数据。这种情况下会缓存和数据库的数据会产生不一致。

但是由于读操作正常情况下，比写操作快。因此一般情况下，这个问题发生的概率很低。 

> 如何解决上述问题？

通过延迟双删。即当写操作更新了数据库，并且删除了缓存之后，等待2-3s,再次删除缓存。这样就会保证旧数据不会出现在缓存中。

## 什么是Read/Write Through机制？

尽管Cache aside 缓存更新机制和延迟双删的方法能够保证缓存和数据库的一致性。但是仍然有出现问题的可能。

Read/Write Through机制如下
- 读取操作和缓存交互，直接读取缓存结果。
- 写入操作也和缓存交互，直接将写入结果存储到缓存中。
- 最后缓存本身与数据库进行数据同步。

简而言之，在Read/Write Through机制中当缓存启动的时候，自身将从数据库中读取数据，并存入到缓存中。然后应用的读取写入操作都与缓存交互，缓存自身再与数据库进行数据同步。

Read/Write Through机制：应用读写数据操作-》缓存-》数据库

