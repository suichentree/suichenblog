---
title: 爬虫笔记02
date: 2024-09-11
sidebar: 'auto'
categories: 
 - 爬虫
---

[toc]

# 爬虫笔记02

参考书籍：爬虫逆向进阶实战[李玺/著]

## 浏览器环境补充（补环境）

浏览器环境补充，即补环境。是指浏览器环境移植到 Node 环境中。

因为 NodeJS 环境和浏览器的JS环境具有一定的区别，比如 window 对象区别、 this 指向区别、Js 引擎区别， 以及一些 DOM 操作区别等。



很多网站也会以此检测来判断是不是真实用户， 此时就需要对 Js
代码进行补充。



补环境逆向方式，主要是指将浏览器环境移植到 Node 环境中，Node Js 采用的内核也为 V8 引擎，同时由于 Node环境 没有界面渲染， 因此在浏览器中可使用的例如 window、 navigator、 dom 等操作在 Node环境 中是不存在的， 所以对于 Node Js 的环境搭建和浏览器环境补齐也是 Js 逆向需要掌握的。

### 浏览器窗口对象的属性

浏览器窗口对象 window 的常见属性和方法。因为浏览器中的很多JS代码都会涉及到 窗口对象 window 的这些属性和方法。因此我们在补环境前， 需要了解 window 对象的常用属性和方法。

1. Window 窗口对象表示浏览器当前打开的窗口，常用属性和方法如下。
```
document属性         返回 Document 对象
history属性          返回 History 对象
location属性         返回 Location 对象
navigator属性        返回 Navigator 对象
screen属性           返回 Screen 对象
scrollBy()方法       按照指定的像素值来滚动内容
scrollTo()方法       把内容滚动到指定的坐标
setInterval()方法    定时器
setTimeout()方法     延时器
alert()方法          弹出警告框
prompt()方法         弹出对话框
open()方法           打开新页面
close()方法          关闭页面
```

2. Document 文档对象，表示浏览器当前显示的 HTML 文档，常用属性和方法如下。
```
body属性                        返回body元素
cookie属性                      返回当前cookie
domain属性                      文档域名
lastModified属性                文档最后修改日期和时间
referrer属性                    访问来源
title属性                       文档标题
URL属性                         当前 URL
getElementById()方法            返回指定 id 的引用对象
getElementsByName()方法         返回指定名称的对象集合
getElementsByTagName()方法      返回指定标签名的对象集合
open()方法                      打开流接收输入输出
write()方法                     向文档输入
```

3. Navigator 对象，表示当前使用的浏览器信息。
```
userAgent属性                   返回用户代理
AppCodeName属性                 浏览器代码名
AppName属性                     浏览器名称
AppVersion属性                  浏览器版本
browserLanguage属性             浏览器语言
cookieEnabled属性               指明是否启用 cookie 的布尔值
cpuClass属性                    浏览器系统的 cpu 等级
onLine属性                      是否处于脱机模式
platform属性                    浏览器的操作系统平台
plugins属性                     插件,所有嵌入式对象的引用
webdriver属性                   是否启用驱动
product属性                     引擎名
hardwareConcurrency属性         硬件支持并发数
connection属性                  网络信息
javaEnabled()方法               是否启用 Java
taintEnabled()方法              是否启用数据污点
```

4. Location对象，包含有关当前 URL 的信息。
```
hash属性                        返回 URL的锚点
host属性                        当前主机名和端口号
hostname属性                    当前主机名
href属性                        当前 URL
pathname属性                    当前 URL 的路径
port属性                        当前 URL 的端口号
protocol属性                    当前 URL 的协议
search属性                      设置 URL 查询部分
assign()方法                    加载新文档
reload()方法                    重新加载文档
replace()方法                   替换当前文档
```

5. Screen对象，表示当前浏览器中屏幕信息

```
availHeight属性                 屏幕高度
availWidth属性                  屏幕宽度
bufferDepth属性                 调色板比特深度
deviceXDPI属性                  显示屏每英寸水平点数
deviceYDPI属性                  显示屏每英寸垂直点数
fontSmoothingEnabled属性        是否启用字体平滑
height属性                      显示屏高度
pixelDepth属性                  显示屏分辨率
updateInterval属性              屏幕刷新率
width属性                       显示屏宽度
```

6. History 对象包含用户在浏览器窗口中访问过的 URL。

```
length                          浏览器历史列表中的 URL 数量
back()                          加载前一个 URL
forward()                       加载下一个 URL
go()                            加载某个具体页面
```
















































## 网站的爬取

网站分为静态网站和动态网站。

### 静态网站的爬取

静态网站的页面内容和数据通常是固定的，服务器上存储的是 HTML 文件以及包含在其中的数据，当用户请求页面时，服务器直接返回这些文件。

> 对于静态网站的爬取，有几种方式。

方式1：
1. 通过 requests 库去请求，获取目标网站的html文本数据。
2. 搭配 html 解析工具 （BeautifulSoup 库 或 lxml库 ），从而获取html文本中的数据。

方式2：
1. 通过 selenium 或 DrissionPage 等模拟浏览器的工具，获取目标网站的html文本数据。
2. 再搭配 selenium 或 DrissionPage 等自带的html 解析工具，来解析html，获得数据。

### 动态网站的爬取

动态网站的页面内容和数据是动态生成的。动态网站会根据用户请求或其他条件实时生成不同的页面内容。它们通常涉及服务器端语言（如 PHP、Python、Ruby 等）和数据库（如 MySQL、PostgreSQL）。

动态网站的动态内容主要分为两种方式：
- 方式1： 直接再服务器中生成渲染好的html页面。返回给客户端。
- 方式2： html页面是固定的，但是服务器通过 AJAX 技术，来返回动态数据给客户端，从而使页面数据显示不同。

> 对于动态网站的爬取，有几种方式。

方式1： 
1. 如果目标网站，每次请求返回的都是渲染好的html页面。
2. 那么可以通过 selenium 或 DrissionPage 等模拟浏览器的工具，直接获取目标网站的html文本数据。
3. 然后搭配 html 解析工具 （BeautifulSoup 库 或 lxml库 ）。解析html文件中的数据。

方式2：
1. 如果目标网站中的数据是通过 AJAX 技术来获取的。
2. 那么可以直接通过 requests 库去请求对于的API接口，从而直接获取网站数据。不必解析网站的html文本。


### 爬虫方法的区别

上面的爬取数据的方式主要分为两种：
- 方式1：直接去请求API接口，要么返回的html文本，要么返回的json数据。
- 方式2：通过模拟浏览器的方式，去获取网站的数据。

方式1的优缺点是：直接请求可以很快速的获取想要的数据。但是有的网站会对数据进行加解密处理。这种方式还需要对数据进行分析，然后通过各种算法或者加密解密之后才能使用。优点就是占用电脑内存小，速度快。但是碰到数据加密解密的情况下，就很复杂。因此这种方式需要的技术含量高。


方式2的优缺点是：通过浏览器工具，来模拟正常用户来访问网站。因此这种方式可以获取网站渲染好的数据结果，无需我们对数据进行分析和加解密处理，拿来就可以用。缺点就是如果爬取大量用户的数据，对电脑的负载要高。

上面两种方式，方式2由于是直接模拟浏览器，因此方式2的爬虫能力比方式1强，可以躲过大部分网站的反爬虫检测。

因此这两种爬虫方法都要掌握，针对不同的网站可以使用不同的爬虫策略。