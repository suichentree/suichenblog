---
title: Python使用Scapy库笔记
date: 2024-07-02
sidebar: 'auto'
categories: 
 - Python
tags:
 - Python
---

[toc]

# Python使用Scapy库笔记

Scapy是一个强大的交互式数据包操作程序，它允许用户发送、嗅探、解码和操纵网络数据包。Scapy提供了丰富的功能和灵活性，使网络工程师、安全专家和开发者能够轻松地分析和操纵网络流量。

## Scapy介绍

Scapy是一个开源项目，基于Python编写，可以用于创建、操纵、发送和捕获网络数据包。

它支持多种操作系统，包括Windows、Linux和macOS。Scapy提供了强大的数据包处理功能，使得用户可以轻松地解析、修改和构建各种协议的数据包。

> Scapy的特点

1. 交互式操作：Scapy提供了交互式命令行界面，使用户能够实时发送、捕获和分析数据包。用户可以在命令行中直接输入数据包参数，如IP地址、端口号等，以创建和发送自定义数据包。
2. 丰富的数据包操作：Scapy支持多种协议的数据包操作，包括TCP、UDP、ICMP、ARP等。用户可以使用Scapy修改数据包的各个字段，如源IP地址、目标端口等，以实现各种网络实验和测试。
3. 数据包编码与解码：Scapy提供了自动编码/解码功能，支持多种协议的数据包编码和解码。用户可以使用Scapy将数据包转换为字节串或将其解析为可读格式。
4. 数据包嗅探与注入：Scapy可以用于嗅探网络流量并实时显示捕获到的数据包信息。此外，用户还可以使用Scapy将自定义数据包注入到网络中，模拟真实的网络流量。
5. 强大的过滤功能：Scapy支持强大的过滤器表达式，允许用户根据需要筛选捕获到的数据包。用户可以使用过滤器表达式来限制捕获的数据包类型、源IP地址等。
6. 可扩展性：Scapy具有高度的可扩展性，用户可以根据自己的需求编写Python脚本来扩展Scapy的功能。这使得Scapy能够适应各种复杂的网络环境，满足不同的需求。
7. 跨平台支持：Scapy能够在多种操作系统上运行，包括Windows、Linux和macOS。这使得用户可以在不同的操作系统上使用相同的工具进行网络分析和测试。


## 安装

pip的方式安装
```bash
pip install scapy
```

## 用法

### 创建一个TCP数据包并发送

```py
# 导入Scapy模块
from scapy.all import *

# 创建一个目标地址为"http://www.example.com"的IP数据包，并使用TCP协议指定目标端口号为80。
packet = IP(dst="www.example.com") / TCP(dport=80)

# send()函数发送数据包
send(packet)
```